---
- name: Backup current repositories
  include_tasks: backup-repos.yml

- name: Check if Subscription Manager is about to be used on non RHEL system
  fail:
    msg: "ovirt_repositories_use_subscription_manager option can be only used on RHEL OS"
  when: ovirt_repositories_use_subscription_manager and ansible_distribution != "RedHat"

- name: Setup repositories using Subscription Manager
  include_tasks: rh-subscription.yml
  when: ovirt_repositories_use_subscription_manager == True

- name: Setup repositories using oVirt release package
  include_tasks: rpm.yml
  when: ovirt_repositories_use_subscription_manager == False
